sudo: required
# language: python
# python:
#   - "3.4"

services:
  - docker

before_script: sudo "PATH=$PATH PYTHONPATH=$PYTHONPATH" pip3 install -r contrib/mmts/tests2/requirements.txt

script: cd contrib/mmts && docker build -t pgmmts . && cd tests2 && sudo "PATH=$PATH" blockade up && sleep 20 && sudo "PATH=$PATH" python3 test_recovery.py

notifications:
  email:
    - s.kelvich@postgrespro.ru


# language: perl
# os:
#   - linux
#   #- osx
# compiler:
#   - gcc
#   - clang
# install: cpanm IPC::Run DBD::Pg Proc::ProcessTable
# before_script: ./configure --enable-cassert --enable-tap-tests && make -j4
# env:
#   #- TESTDIR=.
#   #- TESTDIR=src/test/recovery
#   - TESTDIR=contrib/raftable
#   - TESTDIR=contrib/mmts
# script: cd $TESTDIR && make check
# notifications:
#   email:
#     - s.kelvich@postgrespro.ru
#     - c.pan@postgrespro.ru
#     - k.knizhnik@postgrespro.ru

