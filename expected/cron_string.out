create user __temp_robot;
create user __temp_root WITH  SUPERUSER;
SET SESSION AUTHORIZATION __temp_root;
select schedule.create_job(
    '{
        "name": "Test @reboot",
        "cron": "@reboot",
        "command": "show all",
        "run_as": "__temp_robot"
    }'
);
 create_job 
------------
          1
(1 row)

select schedule.create_job(
    '{
        "name": "Test 1",
        "cron": "* * * * *",
        "command": "select ''this is every minute job''",
        "run_as": "__temp_robot",
        "last_start_available": "2 hours"
    }'
);
 create_job 
------------
          2
(1 row)

select schedule.create_job(
    '{
        "name": "Test 2 4/4 2/4 * * *",
        "cron": "4/4 2/4 * * *",
        "command": "select pg_sleep(10)",
        "run_as": "__temp_robot"
    }'
);
 create_job 
------------
          3
(1 row)

select schedule.create_job(
	'{
		"name": "Test 3",
		"cron": "23 1 * * THU,SUN",
		"command": "select ''ok'' as ok"
	}'
);
 create_job 
------------
          4
(1 row)

select id, node, name, rule, do_sql, same_transaction, postpone, retry from schedule.cron order by id;
 id |  node  |         name         |                                                                                                                                                                                                                                                                                             rule                                                                                                                                                                                                                                                                                             |                do_sql                 | same_transaction | postpone  | retry 
----+--------+----------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+---------------------------------------+------------------+-----------+-------
  1 | master | Test @reboot         | {"crontab": "@reboot", "onstart": 1}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | {"show all"}                          | f                |           |     0
  2 | master | Test 1               | {"days": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], "hours": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "wdays": [0, 1, 2, 3, 4, 5, 6], "months": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "crontab": "* * * * *", "minutes": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]} | {"select 'this is every minute job'"} | f                | @ 2 hours |     0
  3 | master | Test 2 4/4 2/4 * * * | {"days": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], "hours": [2, 6, 10, 14, 18, 22], "wdays": [0, 1, 2, 3, 4, 5, 6], "months": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "crontab": "4/4 2/4 * * *", "minutes": [4, 8, 12, 16, 20, 24, 28, 32, 36, 40, 44, 48, 52, 56]}                                                                                                                                                                                                                                             | {"select pg_sleep(10)"}               | f                |           |     0
  4 | master | Test 3               | {"days": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], "hours": [1], "wdays": [0, 4], "months": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12], "crontab": "23 1 * * THU,SUN", "minutes": [23]}                                                                                                                                                                                                                                                                                                                              | {"select 'ok' as ok"}                 | f                |           |     0
(4 rows)

RESET SESSION AUTHORIZATION;
drop user __temp_root;
drop user __temp_robot;
