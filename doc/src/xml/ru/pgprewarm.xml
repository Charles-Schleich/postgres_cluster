<!-- doc/src/xml/pgprewarm.xml -->

<sect1 id="pgprewarm" xreflabel="pg_prewarm">
 <title>pg_prewarm</title>

 <indexterm zone="pgprewarm"><primary>pg_prewarm</primary></indexterm>

 <para>Модуль <filename>pg_prewarm</filename> предоставляет удобную возможность загружать данные отношений в кеш операционной системы или в кеш буферов <productname>&productname;</productname>.</para>

 <sect2>
  <title>Функции</title>

<synopsis>pg_prewarm(regclass, mode text default 'buffer', fork text default 'main',
           first_block int8 default null,
           last_block int8 default null) RETURNS int8</synopsis>

  <para>Первый аргумент задаёт отношение, которое будет &laquo;разогрето&raquo;. Во втором указывается метод &laquo;разогрева&raquo;, из описанных ниже; в третьем задаётся целевой слой отношения, обычно <literal>main</literal>. В четвёртом аргументе можно передать номер первого разогреваемого блока (<literal>NULL</literal> принимается как синоним нуля), а в пятом — номер последнего блока (<literal>NULL</literal> означает последний блок отношения). Возвращает эта функция количество разогретых блоков.</para>

  <para>Эта функция поддерживает три режима разогрева. В режиме <literal>prefetch</literal> выдаются асинхронные запросы предвыборки данных операционной системе, если они поддерживаются, либо происходит ошибка. В режиме <literal>read</literal> считывается заданный диапазон блоков; в отличие от <literal>prefetch</literal> это происходит синхронно и поддерживается во всех ОС и любыми сборками, но может быть медленнее. В режиме <literal>buffer</literal> запрошенный диапазон блоков считывается в кеш буферов базы данных.</para>

  <para>Заметьте, что с любым из этих методов попытка разогреть больше блоков, чем может уместиться в кеше (в кеше ОС в режимах <literal>prefetch</literal> и <literal>read</literal>, либо в кеше <productname>&productname;</productname> в режиме <literal>buffer</literal>) скорее всего приведёт к тому, что блоки с меньшими номерами будут вытеснены из кеша при чтении последующих блоков. Кроме того, разогретые данные никаким специальным образом не защищаются от вытеснения из кеша, так что возможна ситуация, когда из-за другой активности только что разогретые блоки будут вытеснены вскоре после чтения; с другой стороны при таком разогреве из кеша могут быть вытеснены другие данные. Поэтому разогрев обычно наиболее полезен при загрузке, когда кеши в основном пусты.</para>
 </sect2>

 <sect2>
  <title>Автор</title>

  <para>Роберт Хаас <email>rhaas@postgresql.org</email></para>
 </sect2>

</sect1>
